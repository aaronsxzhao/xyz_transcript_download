const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DP-uypT4.js","assets/markdown-vhK0I3xZ.js","assets/react-vendor-CqdHEJLj.js","assets/syntax-D9IAFz2e.js","assets/index-CAvFOVct.css","assets/markmap-DdJ68iQR.js"])))=>i.map(i=>d[i]);
import{_ as T,h as ue}from"./syntax-D9IAFz2e.js";import{j as e,M as he,r as fe,a as be,b as ye,c as je}from"./markdown-vhK0I3xZ.js";import{r as i,f as ve,e as we,L as V}from"./react-vendor-CqdHEJLj.js";import{c as z,L as R,M as ke,K as $,X as se,N as X,O as Ne,J as Se,I as Ce,C as J,P as ze,G as Re}from"./index-DP-uypT4.js";import{S as ee,Y as Ee}from"./YouTubeCookieGuide-B2HcvLb1.js";import{F as re}from"./file-text-BU7NCz9E.js";import{P as Te}from"./play-WWGm0TfV.js";import{E as D}from"./external-link-DlO8TeUC.js";import{D as oe,S as Ie,A as Me}from"./upload-vXZ544xc.js";import{A as _e}from"./arrow-left-CKD6ohh3.js";import{R as Le}from"./refresh-cw-DMpMlfbd.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=z("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=z("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=z("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=z("FileDown",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=z("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=z("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=z("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=z("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=z("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),$e={'pre[class*="language-"]':{color:"#d4d4d4",fontSize:"13px",textShadow:"none",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",lineHeight:"1.5",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",padding:"1em",margin:".5em 0",overflow:"auto",background:"#1e1e1e"},'code[class*="language-"]':{color:"#d4d4d4",fontSize:"13px",textShadow:"none",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",lineHeight:"1.5",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none"},'pre[class*="language-"]::selection':{textShadow:"none",background:"#264F78"},'code[class*="language-"]::selection':{textShadow:"none",background:"#264F78"},'pre[class*="language-"] *::selection':{textShadow:"none",background:"#264F78"},'code[class*="language-"] *::selection':{textShadow:"none",background:"#264F78"},':not(pre) > code[class*="language-"]':{padding:".1em .3em",borderRadius:".3em",color:"#db4c69",background:"#1e1e1e"},".namespace":{Opacity:".7"},"doctype.doctype-tag":{color:"#569CD6"},"doctype.name":{color:"#9cdcfe"},comment:{color:"#6a9955"},prolog:{color:"#6a9955"},punctuation:{color:"#d4d4d4"},".language-html .language-css .token.punctuation":{color:"#d4d4d4"},".language-html .language-javascript .token.punctuation":{color:"#d4d4d4"},property:{color:"#9cdcfe"},tag:{color:"#569cd6"},boolean:{color:"#569cd6"},number:{color:"#b5cea8"},constant:{color:"#9cdcfe"},symbol:{color:"#b5cea8"},inserted:{color:"#b5cea8"},unit:{color:"#b5cea8"},selector:{color:"#d7ba7d"},"attr-name":{color:"#9cdcfe"},string:{color:"#ce9178"},char:{color:"#ce9178"},builtin:{color:"#ce9178"},deleted:{color:"#ce9178"},".language-css .token.string.url":{textDecoration:"underline"},operator:{color:"#d4d4d4"},entity:{color:"#569cd6"},"operator.arrow":{color:"#569CD6"},atrule:{color:"#ce9178"},"atrule.rule":{color:"#c586c0"},"atrule.url":{color:"#9cdcfe"},"atrule.url.function":{color:"#dcdcaa"},"atrule.url.punctuation":{color:"#d4d4d4"},keyword:{color:"#569CD6"},"keyword.module":{color:"#c586c0"},"keyword.control-flow":{color:"#c586c0"},function:{color:"#dcdcaa"},"function.maybe-class-name":{color:"#dcdcaa"},regex:{color:"#d16969"},important:{color:"#569cd6"},italic:{fontStyle:"italic"},"class-name":{color:"#4ec9b0"},"maybe-class-name":{color:"#4ec9b0"},console:{color:"#9cdcfe"},parameter:{color:"#9cdcfe"},interpolation:{color:"#9cdcfe"},"punctuation.interpolation-punctuation":{color:"#569cd6"},variable:{color:"#9cdcfe"},"imports.maybe-class-name":{color:"#9cdcfe"},"exports.maybe-class-name":{color:"#9cdcfe"},escape:{color:"#d7ba7d"},"tag.punctuation":{color:"#808080"},cdata:{color:"#808080"},"attr-value":{color:"#ce9178"},"attr-value.punctuation":{color:"#ce9178"},"attr-value.punctuation.attr-equals":{color:"#d4d4d4"},namespace:{color:"#4ec9b0"},'pre[class*="language-javascript"]':{color:"#9cdcfe"},'code[class*="language-javascript"]':{color:"#9cdcfe"},'pre[class*="language-jsx"]':{color:"#9cdcfe"},'code[class*="language-jsx"]':{color:"#9cdcfe"},'pre[class*="language-typescript"]':{color:"#9cdcfe"},'code[class*="language-typescript"]':{color:"#9cdcfe"},'pre[class*="language-tsx"]':{color:"#9cdcfe"},'code[class*="language-tsx"]':{color:"#9cdcfe"},'pre[class*="language-css"]':{color:"#ce9178"},'code[class*="language-css"]':{color:"#ce9178"},'pre[class*="language-html"]':{color:"#d4d4d4"},'code[class*="language-html"]':{color:"#d4d4d4"},".language-regex .token.anchor":{color:"#dcdcaa"},".language-html .token.punctuation":{color:"#808080"},'pre[class*="language-"] > code[class*="language-"]':{position:"relative",zIndex:"1"},".line-highlight.line-highlight":{background:"#f7ebc6",boxShadow:"inset 5px 0 0 #f7d87c",zIndex:"0"}},F=[{key:"parsing",label:"Parse",range:[0,10]},{key:"downloading",label:"Download",range:[10,30]},{key:"transcribing",label:"Transcribe",range:[30,60]},{key:"summarizing",label:"AI Notes",range:[60,92]},{key:"success",label:"Done",range:[92,100]}],Ge=F.map(r=>r.key);function qe({currentStatus:r,progress:t=0}){const u=Ge.indexOf(r),y=r==="saving"?3:u;return e.jsx("div",{className:"flex items-center px-2",children:F.map((j,x)=>{const h=y>x||r==="success",f=x===y&&r!=="success";let o=0;if(x<F.length-1){if(h)o=100;else if(f){const[d,p]=j.range;o=Math.min(100,Math.max(0,(t-d)/(p-d)*100))}}return e.jsxs("div",{className:"flex items-center flex-1 last:flex-none",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center text-xs font-medium ${h?"bg-green-600 text-white":f?"bg-indigo-600 text-white":"bg-dark-hover text-gray-500 border border-dark-border"}`,style:{transition:"background-color 0.5s ease"},children:h?e.jsx(ne,{size:14}):f?e.jsx(R,{size:14,className:"animate-spin"}):x+1}),e.jsx("span",{className:`text-[10px] mt-1 whitespace-nowrap ${h||f?"text-gray-300":"text-gray-600"}`,children:j.label})]}),x<F.length-1&&e.jsx("div",{className:"flex-1 h-0.5 mx-1.5 bg-dark-border rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${o}%`,backgroundColor:h?"#16a34a":"#6366f1",transition:"width 1s ease-out, background-color 0.5s ease"}})})]},j.key)})})}function He({task:r}){const[t,u]=i.useState(null),y=ve();if(!r)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[e.jsx(re,{size:48,className:"mb-4 opacity-30"}),e.jsx("p",{className:"text-lg",children:"Select a task or start a new one"}),e.jsx("p",{className:"text-sm mt-1",children:"Your generated notes will appear here"})]});const j=!["success","failed","cancelled","pending"].includes(r.status)&&r.status!=="",x=r.status==="failed",h=r.status==="cancelled",f=r.status==="success";return e.jsxs("div",{children:[j&&e.jsxs("div",{className:"mb-4 flex-shrink-0",children:[e.jsx(qe,{currentStatus:r.status,progress:r.progress}),e.jsxs("div",{className:"flex items-center justify-center gap-3 mt-3",children:[e.jsx("p",{className:"text-xs text-gray-500",children:r.message||"Processing..."}),e.jsxs("button",{onClick:async()=>{try{const{cancelVideoTask:o}=await T(async()=>{const{cancelVideoTask:d}=await import("./index-DP-uypT4.js").then(p=>p.a9);return{cancelVideoTask:d}},__vite__mapDeps([0,1,2,3,4]));await o(r.id)}catch(o){console.error("Cancel failed:",o)}},className:"flex items-center gap-1 px-2 py-0.5 text-xs text-orange-400 hover:text-orange-300 border border-orange-500/30 hover:border-orange-400/50 rounded transition-colors",children:[e.jsx(ee,{size:10,className:"fill-current"}),"Cancel"]})]})]}),r.status==="pending"&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500",children:[e.jsx(R,{size:32,className:"animate-spin mb-3 text-indigo-400"}),e.jsx("p",{children:"Queued for processing..."})]}),x&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500",children:[e.jsx(ke,{size:32,className:"mb-3 text-red-400"}),e.jsx("p",{className:"text-red-400",children:"Processing failed"}),(()=>{const o=(r.error==="LOGIN_REQUIRED"||r.error==="AGE_RESTRICTED"||r.error==="COOKIES_REQUIRED")&&r.platform==="youtube",d=["BILIBILI_LOGIN_REQUIRED","LOGIN_REQUIRED","COOKIES_REQUIRED","AGE_RESTRICTED"].includes(r.error||"")&&!o,l={BILIBILI_LOGIN_REQUIRED:"BiliBili requires login. Please scan the QR code in Settings â†’ BiliBili Login.",LOGIN_REQUIRED:"This video requires login.",COOKIES_REQUIRED:"Server rejected the request.",AGE_RESTRICTED:"This video is age-restricted and requires login.",VIDEO_PRIVATE:"This video is private and cannot be accessed.",VIDEO_UNAVAILABLE:"This video has been removed or is no longer available.",GEO_RESTRICTED:"This video is not available in your region.",COPYRIGHT_BLOCKED:"This video is blocked due to copyright restrictions.",RATE_LIMITED:"Rate limited by the platform. Please wait a few minutes and try again.",FFMPEG_MISSING:"FFmpeg is required but not installed on the server.",UNSUPPORTED_URL:"This URL is not supported. Please check the URL and try again."}[r.error||""]||r.message||r.error||"Unknown error";return e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm mt-2 text-center text-gray-400 max-w-md",children:l}),o&&e.jsx("div",{className:"mt-4 p-4 bg-dark-hover rounded-xl border border-dark-border max-w-md w-full",children:e.jsx(Ee,{compact:!0})}),e.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[(d||o)&&e.jsx("button",{onClick:()=>y("/settings"),className:"flex items-center gap-2 px-4 py-2 bg-pink-600 hover:bg-pink-700 text-white text-sm rounded-lg transition-colors",children:o?"Upload Cookies in Settings":"Go to Settings"}),e.jsxs("button",{onClick:async()=>{try{const{retryVideoTask:n}=await T(async()=>{const{retryVideoTask:c}=await import("./index-DP-uypT4.js").then(m=>m.a9);return{retryVideoTask:c}},__vite__mapDeps([0,1,2,3,4]));await n(r.id)}catch(n){console.error("Retry failed:",n)}},className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white text-sm rounded-lg transition-colors",children:[e.jsx($,{size:14}),"Retry"]})]})]})})()]}),h&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500",children:[e.jsx(ee,{size:32,className:"mb-3 text-orange-400"}),e.jsx("p",{className:"text-orange-400",children:"Processing cancelled"}),e.jsxs("button",{onClick:async()=>{try{const{retryVideoTask:o}=await T(async()=>{const{retryVideoTask:d}=await import("./index-DP-uypT4.js").then(p=>p.a9);return{retryVideoTask:d}},__vite__mapDeps([0,1,2,3,4]));await o(r.id)}catch(o){console.error("Retry failed:",o)}},className:"mt-4 flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white text-sm rounded-lg transition-colors",children:[e.jsx($,{size:14}),"Retry"]})]}),(f||j&&r.markdown)&&r.markdown&&e.jsxs("div",{children:[j&&e.jsxs("div",{className:"flex items-center gap-2 mb-3 px-1 text-xs text-indigo-400",children:[e.jsx(R,{size:12,className:"animate-spin"}),e.jsx("span",{children:"Writing notes..."})]}),e.jsx("article",{className:`prose prose-invert max-w-none pb-4
            prose-headings:text-gray-100 prose-headings:font-bold
            prose-h1:text-2xl prose-h1:border-b prose-h1:border-dark-border prose-h1:pb-2 prose-h1:mb-6
            prose-h2:text-xl prose-h2:mt-8 prose-h2:mb-4 prose-h2:text-indigo-300
            prose-h3:text-lg prose-h3:mt-6 prose-h3:mb-3
            prose-p:text-gray-300 prose-p:leading-7
            prose-li:text-gray-300
            prose-strong:text-white
            prose-a:text-indigo-400 prose-a:no-underline hover:prose-a:underline
            prose-blockquote:border-l-indigo-500 prose-blockquote:bg-indigo-950/30 prose-blockquote:text-gray-300 prose-blockquote:py-1 prose-blockquote:rounded-r
            prose-code:text-indigo-300 prose-code:bg-dark-hover prose-code:px-1 prose-code:py-0.5 prose-code:rounded
            prose-pre:bg-transparent prose-pre:p-0
            prose-img:rounded-lg prose-img:border prose-img:border-dark-border
            prose-hr:border-dark-border prose-hr:my-8
            prose-table:border-collapse prose-th:bg-dark-hover prose-th:border prose-th:border-dark-border prose-th:px-3 prose-th:py-2
            prose-td:border prose-td:border-dark-border prose-td:px-3 prose-td:py-2
          `,children:e.jsx(he,{remarkPlugins:[ye,je],rehypePlugins:[fe,[be,{throwOnError:!1,errorColor:"#94a3b8"}]],components:{p({children:o,...d}){const l=(Array.isArray(o)?o:[o]).map((n,c)=>{if(typeof n!="string")return n;const m=/\*?Screenshot-\[(\d+(?::\d+){1,2})\]\*?/g,w=[];let k=0,S;for(;(S=m.exec(n))!==null;){S.index>k&&w.push(n.slice(k,S.index));const C=S[1];w.push(e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 my-1 bg-slate-700/50 border border-slate-600/50 rounded-lg text-xs text-slate-400",children:[e.jsx(Ve,{size:12}),"Screenshot @ ",C]},`ss-${c}-${C}`)),k=S.index+S[0].length}return w.length===0?n:(k<n.length&&w.push(n.slice(k)),w)});return e.jsx("p",{...d,children:l.flat()})},code({className:o,children:d,...p}){const l=/language-(\w+)/.exec(o||""),n=String(d).replace(/\n$/,"");return l?e.jsx(ue,{style:$e,language:l[1],PreTag:"div",customStyle:{margin:0,borderRadius:"0.5rem",fontSize:"0.8125rem"},children:n}):e.jsx("code",{className:o,...p,children:d})},img({src:o,alt:d}){return e.jsx("img",{src:o,alt:d||"",className:"max-w-[min(100%,480px)] max-h-64 w-auto rounded-lg border border-dark-border cursor-pointer hover:opacity-90 transition-opacity",loading:"lazy",referrerPolicy:"no-referrer",onClick:()=>o&&u(o)})},a({href:o,children:d}){const p=String(d);return(/^â–¶/.test(p)||/åŽŸç‰‡/.test(p))&&o?e.jsxs("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 px-2 py-0.5 bg-indigo-600/20 border border-indigo-500/30 rounded-full text-xs text-indigo-300 hover:bg-indigo-600/40 hover:text-indigo-200 transition-colors no-underline",children:[e.jsx(Te,{size:10,className:"fill-current"}),p.replace(/^â–¶\s*/,"")]}):o!=null&&o.startsWith("#")?e.jsx("a",{href:o,onClick:n=>{n.preventDefault();const c=decodeURIComponent(o.slice(1)),m=document.getElementById(c);if(!m)return;const w=document.getElementById("video-content-scroll");if(w){const k=m.getBoundingClientRect(),S=w.getBoundingClientRect(),C=w.scrollTop+(k.top-S.top)-12;w.scrollTo({top:Math.max(0,C),behavior:"smooth"})}else m.scrollIntoView({behavior:"smooth",block:"start"})},className:"text-indigo-400 hover:underline hover:text-indigo-300 transition-colors",children:d}):e.jsxs("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-400 hover:underline inline-flex items-center gap-0.5",children:[d,e.jsx(D,{size:11,className:"opacity-50"})]})}},children:r.markdown.replace(/^##\s*(?:ç›®å½•|Table of Contents)\s*\n(?:[\s\S]*?)(?=\n---\n|\n## )/m,"").replace(/^\n---\n/m,`
`)})})]}),t&&e.jsxs("div",{className:"fixed inset-0 z-50 bg-black/80 flex items-center justify-center cursor-zoom-out",onClick:()=>u(null),children:[e.jsx("button",{onClick:()=>u(null),className:"absolute top-4 right-4 text-white/70 hover:text-white p-2",children:e.jsx(se,{size:24})}),e.jsx("img",{src:t,alt:"Zoomed screenshot",className:"max-w-[90vw] max-h-[90vh] rounded-lg shadow-2xl"})]}),j&&!r.markdown&&r.status!=="pending"&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500",children:[e.jsxs("div",{className:"relative w-16 h-16 mb-4",children:[e.jsxs("svg",{className:"w-full h-full -rotate-90",viewBox:"0 0 64 64",children:[e.jsx("circle",{cx:"32",cy:"32",r:"28",fill:"none",stroke:"currentColor",strokeWidth:"3",className:"text-dark-border"}),e.jsx("circle",{cx:"32",cy:"32",r:"28",fill:"none",strokeWidth:"3",className:"text-indigo-500",strokeLinecap:"round",strokeDasharray:`${2*Math.PI*28}`,strokeDashoffset:`${2*Math.PI*28*(1-r.progress/100)}`,style:{transition:"stroke-dashoffset 1.2s ease-out"}})]}),e.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-medium text-gray-300",children:[Math.round(r.progress),"%"]})]}),e.jsx("p",{className:"text-sm text-gray-400",children:r.message||"Processing..."})]})]})}function te(r){const t=Math.floor(r/60),u=Math.floor(r%60);return`${t.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`}function Qe({transcript:r}){if(!r)return e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:e.jsx("p",{children:"No transcript available"})});const t=r.segments||[],u=r.duration||0;return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 flex-shrink-0",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-400 uppercase tracking-wider",children:"Transcript"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[t.length," segments",u>0&&` | ${te(u)}`]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-1",children:t.length>0?t.map((y,j)=>e.jsxs("div",{className:"flex gap-2 py-1.5 px-2 rounded hover:bg-dark-hover transition-colors group",children:[e.jsx("span",{className:"text-xs text-indigo-400 font-mono flex-shrink-0 mt-0.5 min-w-[40px]",children:te(y.start)}),e.jsx("p",{className:"text-sm text-gray-300 leading-relaxed",children:y.text})]},j)):e.jsx("div",{className:"p-3 text-sm text-gray-300 leading-relaxed whitespace-pre-wrap",children:r.text})})]})}function Ze({markdown:r}){const t=i.useRef(null),u=i.useRef(null),[y,j]=i.useState(null),[x,h]=i.useState("");i.useEffect(()=>{let l=!1;async function n(){try{const{Transformer:c}=await T(async()=>{const{Transformer:C}=await import("./markmap-DdJ68iQR.js").then(_=>_.i);return{Transformer:C}},__vite__mapDeps([5,1,2])),{Markmap:m}=await T(async()=>{const{Markmap:C}=await import("./markmap-DdJ68iQR.js").then(_=>_.a);return{Markmap:C}},__vite__mapDeps([5,1,2]));if(l||!t.current)return;const w=new c,{root:k}=w.transform(r);t.current.innerHTML="";const S=m.create(t.current,{autoFit:!0,duration:300},k);j(S)}catch(c){console.error("Mind map error:",c),h("Failed to load mind map")}}return r&&n(),()=>{l=!0}},[r]);const f=()=>{if(t.current){const l=t.current.querySelector("g");if(l){const n=l.getAttribute("transform")||"",c=n.match(/scale\(([^)]+)\)/),m=c?parseFloat(c[1]):1;l.setAttribute("transform",n.replace(/scale\([^)]+\)/,`scale(${m*1.2})`))}}},o=()=>{if(t.current){const l=t.current.querySelector("g");if(l){const n=l.getAttribute("transform")||"",c=n.match(/scale\(([^)]+)\)/),m=c?parseFloat(c[1]):1;l.setAttribute("transform",n.replace(/scale\([^)]+\)/,`scale(${m*.8})`))}}},d=()=>{y==null||y.fit()},p=()=>{if(!t.current)return;const l=new XMLSerializer().serializeToString(t.current),n=new Blob([l],{type:"image/svg+xml"}),c=URL.createObjectURL(n),m=document.createElement("a");m.href=c,m.download="mindmap.svg",m.click(),URL.revokeObjectURL(c)};return x?e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:e.jsx("p",{children:x})}):e.jsxs("div",{ref:u,className:"relative h-full w-full",children:[e.jsxs("div",{className:"absolute top-2 right-2 z-10 flex items-center gap-1 bg-dark-surface/90 rounded-lg border border-dark-border p-1",children:[e.jsx("button",{onClick:f,className:"p-1.5 text-gray-400 hover:text-white transition-colors",title:"Zoom In",children:e.jsx(Be,{size:16})}),e.jsx("button",{onClick:o,className:"p-1.5 text-gray-400 hover:text-white transition-colors",title:"Zoom Out",children:e.jsx(Ue,{size:16})}),e.jsx("button",{onClick:d,className:"p-1.5 text-gray-400 hover:text-white transition-colors",title:"Fit to View",children:e.jsx(Ae,{size:16})}),e.jsx("div",{className:"w-px h-5 bg-dark-border mx-0.5"}),e.jsx("button",{onClick:p,className:"p-1.5 text-gray-400 hover:text-white transition-colors",title:"Export SVG",children:e.jsx(oe,{size:16})})]}),e.jsx("svg",{ref:t,className:"w-full h-full",style:{minHeight:"400px"}})]})}function Ke(r){const t=[],u={};for(const y of r.matchAll(/^(#{1,3})\s+(.+)$/gm)){const j=y[1].length,x=y[2].trim();let h=x.toLowerCase().replace(/[^\w\u4e00-\u9fff\s-]/g,"").trim().replace(/\s+/g,"-").replace(/-+/g,"-");const f=h,o=u[f]||0;o>0&&(h=`${f}-${o}`),u[f]=o+1,t.push({level:j,text:x,slug:h})}return t}function it(){var Y;const{taskId:r}=we(),[t,u]=i.useState(null),[y,j]=i.useState(!0),[x,h]=i.useState("markdown"),[f,o]=i.useState(""),[d,p]=i.useState(!1),[l,n]=i.useState(!1),[c,m]=i.useState(!1),[w,k]=i.useState(!1),[S,C]=i.useState([]),[_,G]=i.useState(""),[ae,P]=i.useState(!1),[q,H]=i.useState(!1),[E,Q]=i.useState(""),[v,L]=i.useState(null),A=i.useRef(null),ie=i.useRef(null);i.useEffect(()=>{if(!r)return;let s=!1;const a=async()=>{var N;try{const b=await ze(r);s||(u(b),(N=b.versions)!=null&&N.length&&!f&&o(b.versions[0].id))}catch(b){console.error("Failed to load task:",b)}finally{s||j(!1)}};a();const g=setInterval(()=>{t&&!["success","failed"].includes(t.status)&&a()},3e3);return()=>{s=!0,clearInterval(g)}},[r]);const le=async()=>{const s=O();if(s){try{const{marked:a}=await T(async()=>{const{marked:M}=await import("./marked.esm-CFQ4CE8_.js");return{marked:M}},[]);a.setOptions({gfm:!0,breaks:!1});const g=await a.parse(s),N=new Blob([g],{type:"text/html"}),b=new Blob([s],{type:"text/plain"});await navigator.clipboard.write([new ClipboardItem({"text/html":N,"text/plain":b})])}catch{await navigator.clipboard.writeText(s)}p(!0),setTimeout(()=>p(!1),2e3)}},ce=()=>{const s=O();if(!s||!t)return;const a=new Blob([s],{type:"text/markdown;charset=utf-8"}),g=URL.createObjectURL(a),N=document.createElement("a");N.href=g,N.download=`${t.title||"notes"}.md`,document.body.appendChild(N),N.click(),setTimeout(()=>{document.body.removeChild(N),URL.revokeObjectURL(g)},100)},de=async()=>{const s=O();if(!(!s||l)){n(!0);try{const a=await T(()=>import("./marked.esm-CFQ4CE8_.js"),[]),{marked:g}=a;g.setOptions({gfm:!0,breaks:!1});const N=await g.parse(s),b=window.open("","_blank","width=800,height=600");if(!b){alert("Please allow popups to download PDF");return}b.document.write(`<!DOCTYPE html>
<html><head>
<meta charset="utf-8">
<title>${(t==null?void 0:t.title)||"Notes"}</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans SC", "PingFang SC", "Microsoft YaHei", sans-serif; color: #1f2937; background: #fff; padding: 20px 30px; font-size: 13px; line-height: 1.75; }
  h1 { font-size: 22px; font-weight: 700; color: #111827; border-bottom: 2px solid #e5e7eb; padding-bottom: 8px; margin: 24px 0 16px; }
  h2 { font-size: 18px; font-weight: 700; color: #1e40af; margin: 28px 0 12px; }
  h3 { font-size: 15px; font-weight: 600; color: #1f2937; margin: 20px 0 8px; }
  h4, h5, h6 { font-size: 14px; font-weight: 600; color: #374151; margin: 16px 0 6px; }
  p { font-size: 13px; line-height: 1.75; color: #374151; margin: 8px 0; }
  li { font-size: 13px; line-height: 1.75; color: #374151; }
  ul, ol { padding-left: 20px; margin: 6px 0; }
  strong { color: #111827; }
  a { color: #4f46e5; text-decoration: none; }
  blockquote { border-left: 3px solid #6366f1; background: #eef2ff; color: #374151; padding: 10px 16px; margin: 12px 0; border-radius: 0 6px 6px 0; font-size: 13px; }
  blockquote p { margin: 4px 0; }
  code { font-family: "SF Mono", "Fira Code", monospace; font-size: 12px; color: #6366f1; background: #f3f4f6; padding: 1px 5px; border-radius: 3px; }
  pre { background: #f8fafc; border: 1px solid #e5e7eb; border-radius: 6px; padding: 12px; overflow-x: auto; margin: 12px 0; }
  pre code { background: none; padding: 0; color: #1f2937; font-size: 12px; }
  table { width: 100%; border-collapse: collapse; margin: 12px 0; font-size: 12.5px; }
  th { background: #f3f4f6; font-weight: 600; color: #111827; text-align: left; padding: 8px 10px; border: 1px solid #d1d5db; }
  td { padding: 8px 10px; border: 1px solid #d1d5db; color: #374151; }
  hr { border: none; border-top: 1px solid #e5e7eb; margin: 24px 0; }
  img { max-width: 100%; height: auto; border-radius: 6px; border: 1px solid #e5e7eb; margin: 10px 0; }
  @media print {
    body { padding: 0; }
    table, img, blockquote, pre { page-break-inside: avoid; }
    h1, h2, h3 { page-break-after: avoid; }
  }
</style>
</head><body>${N}</body></html>`),b.document.close();const M=()=>{b.focus(),b.print()};b.onload=()=>setTimeout(M,500),setTimeout(()=>{b.closed||M()},2500)}catch(a){console.error("PDF generation failed:",a)}finally{n(!1)}}},Z=async()=>{if(!(!t||c)){m(!0);try{await Re(t.id)}catch(s){console.error("Regenerate failed:",s)}finally{m(!1)}}},O=()=>{var s;if(!t)return"";if(f&&((s=t.versions)!=null&&s.length)){const a=t.versions.find(g=>g.id===f);if(a!=null&&a.content)return a.content}return t.markdown||""},K=s=>{const a=Math.floor(s/60),g=Math.floor(s%60);return`${a}:${g.toString().padStart(2,"0")}`},I=O(),W=i.useMemo(()=>Ke(I),[I]),xe=s=>{const a=document.getElementById(s);if(!a)return;const g=document.getElementById("video-content-scroll");if(g){const N=a.getBoundingClientRect(),b=g.getBoundingClientRect(),M=g.scrollTop+(N.top-b.top)-12;g.scrollTo({top:Math.max(0,M),behavior:"smooth"})}else a.scrollIntoView({behavior:"smooth",block:"start"})},B=!!localStorage.getItem("notion_api_key"),me=i.useCallback(async()=>{k(!0),L(null),Q(""),G(""),P(!0);try{const s=await X();C(s.pages)}catch(s){L({ok:!1,message:s instanceof Error?s.message:"Failed to load pages"})}finally{P(!1)}},[]),pe=i.useCallback(s=>{G(s),A.current&&clearTimeout(A.current),A.current=setTimeout(async()=>{P(!0);try{const a=await X(s||void 0);C(a.pages)}catch{}finally{P(!1)}},400)},[]),ge=i.useCallback(async()=>{if(!(!r||!E)){H(!0),L(null);try{const s=await Ne(r,E);L({ok:!0,message:`Exported "${s.title}" to Notion`,url:s.url})}catch(s){L({ok:!1,message:s instanceof Error?s.message:"Export failed"})}finally{H(!1)}}},[r,E]);if(y)return e.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:e.jsx(R,{className:"w-8 h-8 animate-spin text-indigo-500"})});if(!t)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-[60vh] text-gray-500",children:[e.jsx("p",{children:"Task not found"}),e.jsx(V,{to:"/videos",className:"text-indigo-400 mt-2",children:"Back to Videos"})]});const U=t.versions||[];return e.jsxs("div",{className:"flex flex-col h-[calc(100vh-5rem)] md:h-[calc(100vh-6rem)]",children:[e.jsxs("div",{className:"flex items-center justify-between pb-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(V,{to:"/videos",className:"p-1.5 text-gray-400 hover:text-white transition-colors flex-shrink-0",children:e.jsx(_e,{size:18})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-base font-semibold text-white truncate",children:t.title||(t.url?(()=>{try{const s=new URL(t.url);return s.hostname.replace("www.","")+s.pathname.replace(/\/$/,"")}catch{return t.url}})():"Untitled")}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-0.5",children:[t.status==="failed"&&e.jsx("span",{className:"px-1.5 py-0.5 bg-red-600/20 text-red-400 rounded-full text-[10px]",children:"Failed"}),t.style&&e.jsx("span",{className:"px-1.5 py-0.5 bg-purple-600/20 text-purple-400 rounded-full text-[10px]",children:t.style}),t.duration>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Se,{size:10})," ",K(t.duration)]}),t.platform&&e.jsx("span",{children:t.platform})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[U.length>1&&e.jsx("select",{value:f,onChange:s=>o(s.target.value),className:"px-2 py-1 bg-dark-hover border border-dark-border rounded text-xs text-white",children:U.map((s,a)=>e.jsxs("option",{value:s.id,children:["v",U.length-a," - ",s.style||"default"]},s.id))}),e.jsxs("div",{className:"flex bg-dark-hover rounded-lg p-0.5",children:[e.jsxs("button",{onClick:()=>h("markdown"),className:`px-2.5 py-1 rounded text-xs transition-colors ${x==="markdown"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white"}`,children:[e.jsx(re,{size:12,className:"inline mr-1"}),"Note"]}),e.jsxs("button",{onClick:()=>h("mindmap"),className:`px-2.5 py-1 rounded text-xs transition-colors ${x==="mindmap"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white"}`,children:[e.jsx(Fe,{size:12,className:"inline mr-1"}),"Mind Map"]}),e.jsx("button",{onClick:()=>h("transcript"),className:`px-2.5 py-1 rounded text-xs transition-colors ${x==="transcript"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white"}`,children:"Transcript"})]}),I&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:le,className:"p-1.5 text-gray-400 hover:text-white transition-colors",title:"Copy as rich text (paste into Notion)",children:d?e.jsx(ne,{size:14,className:"text-green-400"}):e.jsx(Pe,{size:14})}),e.jsx("button",{onClick:ce,className:"p-1.5 text-gray-400 hover:text-white transition-colors",title:"Download .md",children:e.jsx(oe,{size:14})}),t.status==="success"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:de,disabled:l,className:"p-1.5 text-gray-400 hover:text-white transition-colors disabled:opacity-50",title:"Download PDF",children:l?e.jsx(R,{size:14,className:"animate-spin"}):e.jsx(Oe,{size:14})}),e.jsx("button",{onClick:me,className:"p-1.5 text-gray-400 hover:text-orange-400 transition-colors",title:"Send to Notion",children:e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 100 100",fill:"currentColor",children:e.jsx("path",{d:"M6.6 12.3c4.2 3.1 5.8 2.9 13.7 2.1l49.5-3.7c1.6 0 .3-1.6-.3-1.8l-8.2-6c-2.4-1.8-5.5-3.9-11.5-3.4L2.7 3.1C-.5 3.4-1.3 5.1.8 6.8zm4.5 14.7v52c0 2.8 1.4 3.8 4.5 3.6l54.4-3.2c3.2-.2 3.5-2.1 3.5-4.3V23.4c0-2.2-.9-3.4-2.8-3.2L15.8 23.3c-2.1.2-2.8 1.2-2.8 3.2v.5zM64 27c.3 1.4 0 2.8-1.4 3l-2.6.5v38.4c-2.3 1.2-4.4 1.9-6.2 1.9-2.8 0-3.5-.9-5.6-3.5L31.6 40.3v24.4l5.4 1.2s0 2.8-3.9 2.8l-10.8.6c-.3-.6 0-2.2 1.1-2.4l2.8-.8V33.7l-3.9-.3c-.3-1.4.5-3.5 2.8-3.7l11.6-.7 17.2 26.3V33l-4.5-.5c-.3-1.6 1-2.8 2.6-2.9l11.1-.6zM2.2 1.7l50.3-3.8c6.2-.5 7.8-.2 11.6 2.8l16 11.2c2.6 1.9 3.5 2.4 3.5 4.5V78c0 4.3-1.6 6.8-7.1 7.2L18.5 88.6c-4.1.2-6.1-.4-8.2-3.1L1.6 74.3C-.3 71.6-1 69.7-1 67.2v-60c0-3.4 1.6-6.2 5.1-5.5z",transform:"translate(10 5) scale(0.9)"})})})]})]}),["success","failed","cancelled"].includes(t.status)&&e.jsxs("button",{onClick:Z,disabled:c,className:"flex items-center gap-1 ml-1 px-2 py-1 text-xs text-indigo-400 hover:text-indigo-300 border border-indigo-500/30 hover:border-indigo-400/50 rounded-lg transition-colors disabled:opacity-50",title:"Regenerate notes",children:[e.jsx(Le,{size:13,className:c?"animate-spin":""}),"Regenerate"]})]})]}),t.status==="failed"&&e.jsx("div",{className:"flex-shrink-0 mb-3 p-4 bg-red-500/10 border border-red-500/30 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ce,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-medium text-red-400 mb-1",children:"Processing Failed"}),(t.error||t.message)&&e.jsx("p",{className:"text-xs text-red-400/80 mb-2",children:t.error||t.message}),t.url&&e.jsxs("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-indigo-400 hover:text-indigo-300 mb-2",children:[e.jsx(D,{size:10}),e.jsx("span",{className:"truncate max-w-xs",children:t.url})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("button",{onClick:Z,disabled:c,className:"flex items-center gap-1.5 px-3 py-1.5 bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50 text-white text-xs rounded-lg transition-colors",children:[e.jsx($,{size:12,className:c?"animate-spin":""}),"Retry"]}),e.jsx(V,{to:"/settings",className:"flex items-center gap-1.5 px-3 py-1.5 bg-dark-hover hover:bg-dark-border text-gray-300 text-xs rounded-lg transition-colors",children:"Check Settings"})]})]})]})}),e.jsxs("div",{className:"flex-1 flex gap-4 min-h-0",children:[e.jsxs("aside",{className:"w-64 flex-shrink-0 hidden lg:flex flex-col gap-3 overflow-y-auto custom-scrollbar",children:[e.jsxs("div",{className:"bg-dark-surface rounded-xl border border-dark-border p-3 flex-shrink-0",children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Info"}),e.jsxs("div",{className:"space-y-1.5 text-xs text-gray-400",children:[t.platform&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Platform"}),e.jsx("span",{className:"text-white capitalize",children:t.platform})]}),t.duration>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Duration"}),e.jsx("span",{className:"text-white",children:K(t.duration)})]}),t.style&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Style"}),e.jsx("span",{className:"text-white",children:t.style})]}),t.model&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Model"}),e.jsx("span",{className:"text-white truncate ml-2 max-w-[120px]",children:t.model})]}),((Y=t.formats)==null?void 0:Y.length)>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Formats"}),e.jsx("span",{className:"text-white",children:t.formats.join(", ")})]})]})]}),W.length>0&&x==="markdown"&&e.jsxs("div",{className:"bg-dark-surface rounded-xl border border-dark-border p-3 flex-shrink-0",children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Contents"}),e.jsx("nav",{className:"space-y-0.5",children:W.map((s,a)=>e.jsxs("button",{onClick:()=>xe(s.slug),className:"block w-full text-left text-xs text-gray-400 hover:text-indigo-400 transition-colors py-0.5 truncate",style:{paddingLeft:`${(s.level-1)*12}px`},title:s.text,children:[e.jsx(De,{size:10,className:"inline mr-1 opacity-50"}),s.text]},a))})]})]}),e.jsx("div",{className:"flex-1 min-w-0 overflow-y-auto custom-scrollbar bg-dark-surface rounded-xl border border-dark-border p-4",id:"video-content-scroll",children:!["success","failed","cancelled"].includes(t.status)&&!I?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4",children:[e.jsx(R,{className:"w-10 h-10 animate-spin text-indigo-500"}),e.jsx("p",{className:"text-lg text-white font-medium",children:t.status==="pending"?"Queued for processing...":t.status==="downloading"?"Downloading video...":t.status==="transcribing"?"Transcribing audio...":t.status==="summarizing"?"Generating notes...":t.status==="saving"?"Saving results...":"Processing..."}),t.progress>0&&e.jsxs("div",{className:"w-48",children:[e.jsx("div",{className:"h-1.5 bg-dark-border rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-500",style:{width:`${Math.min(t.progress,100)}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[Math.round(t.progress),"%"]})]}),t.message&&e.jsx("p",{className:"text-sm text-gray-400 max-w-md",children:t.message})]}):e.jsxs(e.Fragment,{children:[x==="markdown"&&e.jsx(He,{task:{...t,markdown:I}}),x==="mindmap"&&e.jsx(Ze,{markdown:I}),x==="transcript"&&e.jsx(Qe,{transcript:t.transcript})]})})]}),w&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:s=>{s.target===s.currentTarget&&k(!1)},children:e.jsxs("div",{ref:ie,className:"bg-dark-surface border border-dark-border rounded-2xl w-full max-w-md mx-4 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-border",children:[e.jsxs("h2",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 100 100",fill:"currentColor",className:"text-orange-400",children:e.jsx("path",{d:"M6.6 12.3c4.2 3.1 5.8 2.9 13.7 2.1l49.5-3.7c1.6 0 .3-1.6-.3-1.8l-8.2-6c-2.4-1.8-5.5-3.9-11.5-3.4L2.7 3.1C-.5 3.4-1.3 5.1.8 6.8zm4.5 14.7v52c0 2.8 1.4 3.8 4.5 3.6l54.4-3.2c3.2-.2 3.5-2.1 3.5-4.3V23.4c0-2.2-.9-3.4-2.8-3.2L15.8 23.3c-2.1.2-2.8 1.2-2.8 3.2v.5zM64 27c.3 1.4 0 2.8-1.4 3l-2.6.5v38.4c-2.3 1.2-4.4 1.9-6.2 1.9-2.8 0-3.5-.9-5.6-3.5L31.6 40.3v24.4l5.4 1.2s0 2.8-3.9 2.8l-10.8.6c-.3-.6 0-2.2 1.1-2.4l2.8-.8V33.7l-3.9-.3c-.3-1.4.5-3.5 2.8-3.7l11.6-.7 17.2 26.3V33l-4.5-.5c-.3-1.6 1-2.8 2.6-2.9l11.1-.6zM2.2 1.7l50.3-3.8c6.2-.5 7.8-.2 11.6 2.8l16 11.2c2.6 1.9 3.5 2.4 3.5 4.5V78c0 4.3-1.6 6.8-7.1 7.2L18.5 88.6c-4.1.2-6.1-.4-8.2-3.1L1.6 74.3C-.3 71.6-1 69.7-1 67.2v-60c0-3.4 1.6-6.2 5.1-5.5z",transform:"translate(10 5) scale(0.9)"})}),"Send to Notion"]}),e.jsx("button",{onClick:()=>k(!1),className:"p-1 text-gray-400 hover:text-white transition-colors",children:e.jsx(se,{size:16})})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[B?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ie,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"}),e.jsx("input",{type:"text",value:_,onChange:s=>pe(s.target.value),placeholder:"Search pages...",className:"w-full pl-9 pr-3 py-2 bg-dark-hover border border-dark-border text-white text-sm rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",autoFocus:!0})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto custom-scrollbar space-y-0.5",children:ae?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(R,{size:20,className:"animate-spin text-gray-500"})}):S.length===0?e.jsx("div",{className:"text-center py-8 text-sm text-gray-500",children:(v==null?void 0:v.ok)===!1?"Could not load pages":"No pages found. Share pages with your integration in Notion."}):S.map(s=>e.jsxs("button",{onClick:()=>Q(s.id===E?"":s.id),className:`w-full flex items-center gap-2.5 px-3 py-2 rounded-lg text-left text-sm transition-colors ${s.id===E?"bg-orange-500/15 border border-orange-500/40 text-white":"hover:bg-dark-hover text-gray-300 border border-transparent"}`,children:[e.jsx("span",{className:"flex-shrink-0 w-5 text-center",children:s.icon||"ðŸ“„"}),e.jsx("span",{className:"truncate flex-1",children:s.title||"Untitled"}),s.id===E&&e.jsx(J,{size:14,className:"text-orange-400 flex-shrink-0"})]},s.id))})]}):e.jsxs("div",{className:"space-y-3 py-2",children:[e.jsx("p",{className:"text-sm text-gray-300",children:"Set up your Notion integration to export notes."}),e.jsxs("ol",{className:"text-xs text-gray-400 space-y-1.5 list-decimal list-inside",children:[e.jsxs("li",{children:["Go to ",e.jsxs("a",{href:"https://www.notion.so/profile/integrations",target:"_blank",rel:"noopener noreferrer",className:"text-orange-400 hover:text-orange-300",children:["Notion Integrations ",e.jsx(D,{size:10,className:"inline"})]})]}),e.jsx("li",{children:"Create an integration and copy the token"}),e.jsxs("li",{children:["Go to ",e.jsx(V,{to:"/settings",className:"text-orange-400 hover:text-orange-300",children:"Settings"})," and paste it in the Notion section"]}),e.jsx("li",{children:"Share target pages with your integration in Notion"})]})]}),v&&e.jsxs("div",{className:`p-2.5 rounded-lg text-xs ${v.ok?"bg-green-500/10 border border-green-500/30 text-green-400":"bg-red-500/10 border border-red-500/30 text-red-400"}`,children:[v.ok?e.jsx(J,{size:12,className:"inline mr-1.5"}):e.jsx(Me,{size:12,className:"inline mr-1.5"}),v.message,v.url&&e.jsxs("a",{href:v.url,target:"_blank",rel:"noopener noreferrer",className:"ml-2 inline-flex items-center gap-1 text-orange-400 hover:text-orange-300",children:["Open in Notion ",e.jsx(D,{size:10})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 p-4 border-t border-dark-border",children:[e.jsx("button",{onClick:()=>k(!1),className:"px-4 py-2 text-sm text-gray-400 hover:text-white transition-colors",children:v!=null&&v.ok?"Done":B?"Cancel":"Close"}),B&&!(v!=null&&v.ok)&&e.jsxs("button",{onClick:ge,disabled:!E||q,className:"inline-flex items-center gap-2 px-4 py-2 bg-orange-600 hover:bg-orange-700 disabled:opacity-40 disabled:cursor-not-allowed text-white text-sm font-medium rounded-lg transition-colors",children:[q?e.jsx(R,{size:14,className:"animate-spin"}):e.jsx(D,{size:14}),"Export"]})]})]})})]})}export{it as default};
